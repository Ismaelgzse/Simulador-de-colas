<header class="contentHeader">
  <div class="subMenu">
    <div class="row justify-content-start">
      <div class="col-2">
        <div class="backAndTitle">
          <a class="backButton" routerLink="/home"><i class="fa-solid fa-arrow-left"></i></a>
          <span class="simulationTitle">{{simulationTitle}}</span>
        </div>
      </div>
      <div class="d-sm-none d-lg-block col-lg-1  align-self-center">

      </div>
      <div class="col-sm-3 col-lg-2 align-self-center templateSet ">
        <div class="templateTitle">Plantillas o ejemplos prediseñados</div>
        <select class="form-select templateSelector" aria-label="Default select example">
          <option selected>Selecciona para elegir una plantilla</option>
          <option value="1">Ninguno</option>
          <option value="2">M/M/1/FIFO</option>
          <option value="3">M/M/1/LIFO</option>
          <option value="4">M/M/2/FIFO</option>
          <option value="5">M/M/2/LIFO</option>
        </select>
      </div>
      <div class="d-sm-none d-lg-block col-lg-2 align-self-center">
      </div>
      <div class="col-sm-3 col-lg-2 align-self-center templateSet">
        <div class="templateTitle">Controles de simulación</div>
        <div class="row">
          <div class="col-4">
            <div class="titleControls">Terminar</div>
            <i class="fa-solid fa-stop"></i>
          </div>
          <div class="col-4">
            <div class="titleControls">Pausar</div>
            <i class="fa-solid fa-pause"></i>
          </div>
          <div class="col-4">
            <div class="titleControls">Iniciar</div>
            <i class="fa-solid fa-play"></i>
          </div>
        </div>
      </div>
      <div class="col-1">
        <button type="button" (click)="openModalQuickSimulation(quickSimulation)" class="btn btnForward"
                data-toggle="modal" data-target="#modalSimulation">
          <i class="fa-solid fa-forward"></i>
          Simulación rápida
        </button>
      </div>
      <div class="col-sm-3 col-lg-2 align-self-end save">
        <button class="btn btnSave" data-toggle="modal" data-target="#modalNewFolder">
          <i class="fa-regular fa-floppy-disk"></i>
          Guardar
        </button>
      </div>
    </div>
  </div>
</header>

<div class="leftMenuContainer">
  <div class="leftMenu">
    <div class="titleDragItems">Crea tu modelo</div>
    <div class="textDragItems">Arrastra los elementos de modelado al canvas central</div>
    <div class="dragItemContainer">
      <div class="titleDragContainer">Fuente</div>
      <div id="Fuen" class="image" draggable="true">
        <svg width="200" height="100" cursor="grab">
          <g stroke="black" stroke-width="1px" fill="white">
            <rect x="27.5px" y="1" width="145" height="90" rx="6.93" ry="6.93" fill="rgb(255,255,255)"
                  stroke="rgb(0, 0, 0)"
                  stroke-width="2.1"></rect>
            <text x="32%" y="65%" alignment-baseline="middle" text-anchor="middle" fill="black"
                  stroke="none">Out:
            </text>
          </g>
          <g stroke="black" stroke-width="1px" fill="white">
            <rect x="27.5px" y="1" width="145" height="36.2" rx="6.93" ry="6.93" fill="#3399ff"
                  stroke="rgb(0, 0, 0)"
                  stroke-width="2.1"></rect>
            <text x="50%" y="22.5%" alignment-baseline="middle" text-anchor="middle" fill="black"
                  stroke="none">Fuente
            </text>

          </g>
        </svg>
      </div>
    </div>
    <div class="dragItemContainer">
      <div class="titleDragContainer">Cola</div>
      <div id="Cola" class="image" draggable="true">
        <svg width="200" height="100" cursor="grab">
          <g stroke="black" stroke-width="1px" fill="white">
            <rect x="27.5px" y="1" width="145" height="90" rx="6.93" ry="6.93" fill="rgb(255,255,255)"
                  stroke="rgb(0, 0, 0)"
                  stroke-width="2.1"></rect>
            <text x="32%" y="65%" alignment-baseline="middle" text-anchor="middle" fill="black"
                  stroke="none">In:
            </text>
          </g>
          <g stroke="black" stroke-width="1px" fill="white">
            <rect x="27.5px" y="1" width="145" height="36.2" rx="6.93" ry="6.93" fill="#00ff99"
                  stroke="rgb(0, 0, 0)"
                  stroke-width="2.1"></rect>
            <text x="50%" y="22.5%" alignment-baseline="middle" text-anchor="middle" fill="black"
                  stroke="none">Cola
            </text>

          </g>
        </svg>
      </div>
    </div>
    <div class="dragItemContainer">
      <div class="titleDragContainer">Procesador</div>
      <div id="Proc" class="image" draggable="true">
        <svg width="200" height="100" cursor="grab">
          <g stroke="black" stroke-width="1px" fill="white">
            <rect x="27.5px" y="1" width="145" height="90" rx="6.93" ry="6.93" fill="rgb(255,255,255)"
                  stroke="rgb(0, 0, 0)"
                  stroke-width="2.1"></rect>
            <text x="32%" y="65%" alignment-baseline="middle" text-anchor="middle" fill="black"
                  stroke="none">Util:
            </text>

          </g>
          <g stroke="black" stroke-width="1px" fill="white">
            <rect x="27.5px" y="1" width="145" height="36.2" rx="6.93" ry="6.93" fill="#ffcc00"
                  stroke="rgb(0, 0, 0)"
                  stroke-width="2.1"></rect>
            <text x="50%" y="22.5%" alignment-baseline="middle" text-anchor="middle" fill="black"
                  stroke="none">Procesador
            </text>

          </g>
        </svg>
      </div>
    </div>
    <div class="dragItemContainer">
      <div class="titleDragContainer">Sumidero</div>
      <div id="Sumi" class="image" draggable="true">
        <svg width="200" height="100" cursor="grab">
          <g stroke="black" stroke-width="1px" fill="white">
            <rect x="27.5px" y="1" width="145" height="90" rx="6.93" ry="6.93" fill="rgb(255,255,255)"
                  stroke="rgb(0, 0, 0)"
                  stroke-width="2.1"></rect>
            <text x="32%" y="65%" alignment-baseline="middle" text-anchor="middle" fill="black"
                  stroke="none">In:
            </text>

          </g>
          <g stroke="black" stroke-width="1px" fill="white">
            <rect x="27.5px" y="1" width="145" height="36.2" rx="6.93" ry="6.93" fill="#ff6699"
                  stroke="rgb(0, 0, 0)"
                  stroke-width="2.1"></rect>
            <text x="50%" y="22.5%" alignment-baseline="middle" text-anchor="middle" fill="black"
                  stroke="none">Sumidero
            </text>

          </g>
        </svg>
      </div>
    </div>
  </div>
</div>


<div id="newConnect" class="alertNewConnection">Nueva conexión <i (click)="cancelNewConnection()" type="button"
                                                                  class="fa-solid fa-xmark"></i></div>
<div id="cancelConnect" class="alertCancelConnection">
  <span *ngIf="errorConnection===1">No se puede unir a sí mismo, selecciona otro item.</span>
  <span *ngIf="errorConnection===2">Ya existe una conexión entre ambos items.</span>
</div>


<div id="canvas" class="canvas">
  <div class="blackScreen" id="blackScreen"></div>


  <svg height="100%" width="100%" style="position: absolute;">
    <!--
    <line [attr.x1]="connection.originItem.positionX+100" [attr.y1]="connection.originItem.positionY+75" [attr.x2]="connection.destinationItem.positionX+25" [attr.y2]="connection.destinationItem.positionY+75" style="stroke:rgb(255,0,0);stroke-width:2" />
 -->
    <defs>
      <marker id="arrow" markerWidth="10" markerHeight="10" refX="8" refY="3" orient="auto">
        <path d="M0,0 L0,6 L9,3 z" fill="black"/>
      </marker>
    </defs>
    <!--
        <path
          id='arrow-line'
          marker-end='url(#head)'
          stroke-width='3'
          fill='none' stroke='black'
          [attr.d]="'M '+(connection.originItem.positionX+100)+','+(connection.originItem.positionY+75)+' '+(connection.destinationItem.positionX+15)+','+(connection.destinationItem.positionY+75)"/>
    -->
    <polyline *ngFor="let connection of listConnections;let i=index"
              [attr.points]="(connection.originItem.positionX+100)+','+(connection.originItem.positionY+75)+','+(connection.originItem.positionX+100)+','+(connection.destinationItem.positionY+75)+','+(connection.destinationItem.positionX+15)+','+(connection.destinationItem.positionY+75)"
              style="stroke:black;fill:transparent;stroke-width: 3" marker-end="url(#arrow)"/>

    <polyline *ngFor="let connection of listConnections;let i=index"
              (click)="openModalDeleteConnection(deleteConnection,connection)"
              [attr.points]="(connection.originItem.positionX+100)+','+(connection.originItem.positionY+75)+','+(connection.originItem.positionX+100)+','+(connection.destinationItem.positionY+75)+','+(connection.destinationItem.positionX+15)+','+(connection.destinationItem.positionY+75)"
              style="stroke:transparent;fill:transparent;stroke-width: 37; cursor: pointer"/>


  </svg>


  <div *ngIf="blackScreen">
    <div *ngFor="let itemContainer of listItems; let i=index" id="{{itemContainer.item.name}}"
         style="position: absolute; left:{{itemContainer.item.positionX}}px; top:{{itemContainer.item.positionY}}px"
         (click)="newConnection($event,itemContainer)">
      <svg *ngIf="itemContainer.item.description==='Sink' && (correctSinkShown || sameElement==itemContainer.item.name)"
           width="200" height="100">
        <g stroke="black" stroke-width="1px" fill="white">
          <rect x="27.5px" y="1" width="145" height="90" rx="6.93" ry="6.93" fill="rgb(255,255,255)"
                stroke="rgb(0, 0, 0)"
                stroke-width="2.1"></rect>
          <text x="32%" y="65%" alignment-baseline="middle" text-anchor="middle" fill="black"
                stroke="none">In:
          </text>
        </g>
        <g stroke="black" stroke-width="1px" fill="white">
          <rect x="27.5px" y="1" width="145" height="36.2" rx="6.93" ry="6.93" fill="#ff6699"
                stroke="rgb(0, 0, 0)"
                stroke-width="2.1"></rect>
          <text x="50%" y="22.5%" alignment-baseline="middle" text-anchor="middle" fill="black"
                stroke="none">{{itemContainer.item.name}}
          </text>
        </g>
      </svg>

      <svg
        *ngIf="itemContainer.item.description==='Source' && (correctSourceSown || sameElement==itemContainer.item.name)"
        width="200" height="100">
        <g stroke="black" stroke-width="1px" fill="white">
          <rect x="27.5px" y="1" width="145" height="90" rx="6.93" ry="6.93" fill="rgb(255,255,255)"
                stroke="rgb(0, 0, 0)"
                stroke-width="2.1"></rect>
          <text x="32%" y="65%" alignment-baseline="middle" text-anchor="middle" fill="black"
                stroke="none">Out:
          </text>
        </g>
        <g stroke="black" stroke-width="1px" fill="white">
          <rect x="27.5px" y="1" width="145" height="36.2" rx="6.93" ry="6.93" fill="#3399ff"
                stroke="rgb(0, 0, 0)"
                stroke-width="2.1"></rect>
          <text x="50%" y="22.5%" alignment-baseline="middle" text-anchor="middle" fill="black"
                stroke="none">{{itemContainer.item.name}}
          </text>
        </g>
      </svg>

      <svg
        *ngIf="itemContainer.item.description==='Queue' && (correctQueueShown|| sameElement==itemContainer.item.name)"
        width="200" height="100">
        <g stroke="black" stroke-width="1px" fill="white">
          <rect x="27.5px" y="1" width="145" height="90" rx="6.93" ry="6.93" fill="rgb(255,255,255)"
                stroke="rgb(0, 0, 0)"
                stroke-width="2.1"></rect>
          <text x="32%" y="65%" alignment-baseline="middle" text-anchor="middle" fill="black"
                stroke="none">In:
          </text>
        </g>
        <g stroke="black" stroke-width="1px" fill="white">
          <rect x="27.5px" y="1" width="145" height="36.2" rx="6.93" ry="6.93" fill="#00ff99"
                stroke="rgb(0, 0, 0)"
                stroke-width="2.1"></rect>
          <text x="50%" y="22.5%" alignment-baseline="middle" text-anchor="middle" fill="black"
                stroke="none">{{itemContainer.item.name}}
          </text>
        </g>
      </svg>

      <svg
        *ngIf="itemContainer.item.description==='Server' && (correctServerShown || sameElement==itemContainer.item.name)"
        width="200" height="100">
        <g stroke="black" stroke-width="1px" fill="white">
          <rect x="27.5px" y="1" width="145" height="90" rx="6.93" ry="6.93" fill="rgb(255,255,255)"
                stroke="rgb(0, 0, 0)"
                stroke-width="2.1"></rect>
          <text x="32%" y="65%" alignment-baseline="middle" text-anchor="middle" fill="black"
                stroke="none">Util:
          </text>
        </g>
        <g stroke="black" stroke-width="1px" fill="white">
          <rect x="27.5px" y="1" width="145" height="36.2" rx="6.93" ry="6.93" fill="#ffcc00"
                stroke="rgb(0, 0, 0)"
                stroke-width="2.1"></rect>
          <text x="50%" y="22.5%" alignment-baseline="middle" text-anchor="middle" fill="black"
                stroke="none">{{itemContainer.item.name}}
          </text>
        </g>
      </svg>
    </div>
  </div>

  <div *ngIf="!blackScreen">
    <div *ngFor="let itemContainer of listItems; let i=index" id="{{itemContainer.item.name}}"
         (dragstart)="this.drag($event)" class="images" draggable="true"
         style="position: absolute; left:{{itemContainer.item.positionX}}px; top:{{itemContainer.item.positionY}}px">
      <div id="actionButtons" class="buttons">
        <i class=" actionButton fa-solid fa-arrow-trend-up" type="button" *ngIf="itemContainer.item.description!='Sink'"
           (click)="newConnection($event,itemContainer)"></i>
        <i *ngIf="itemContainer.item.description==='Source'" type='button'
           class='actionButton fa-regular fa-pen-to-square' (click)="openModalEdit(editSource,itemContainer)"></i>
        <i *ngIf="itemContainer.item.description==='Sink'" type='button'
           class='actionButton fa-regular fa-pen-to-square'
           (click)="openModalEdit(editSink,itemContainer)"></i>
        <i *ngIf="itemContainer.item.description==='Server'" type='button'
           class='actionButton fa-regular fa-pen-to-square' (click)="openModalEdit(editServer,itemContainer)"></i>
        <i *ngIf="itemContainer.item.description==='Queue'" type='button'
           class='actionButton fa-regular fa-pen-to-square' (click)="openModalEdit(editQueue,itemContainer)"></i>
        <i type='button' class='actionButton fa-regular fa-trash-can'
           (click)="openModalDeleteItem(deleteItem,itemContainer)"></i>
      </div>

      <svg *ngIf="itemContainer.item.description==='Sink'" width="200" height="100" cursor="all-scroll">
        <g stroke="black" stroke-width="1px" fill="white">
          <rect x="27.5px" y="1" width="145" height="90" rx="6.93" ry="6.93" fill="rgb(255,255,255)"
                stroke="rgb(0, 0, 0)"
                stroke-width="2.1"></rect>
          <text x="32%" y="65%" alignment-baseline="middle" text-anchor="middle" fill="black"
                stroke="none">In:
          </text>
        </g>
        <g stroke="black" stroke-width="1px" fill="white">
          <rect x="27.5px" y="1" width="145" height="36.2" rx="6.93" ry="6.93" fill="#ff6699"
                stroke="rgb(0, 0, 0)"
                stroke-width="2.1"></rect>
          <text x="50%" y="22.5%" alignment-baseline="middle" text-anchor="middle" fill="black"
                stroke="none">{{itemContainer.item.name}}
          </text>
        </g>
      </svg>

      <svg *ngIf="itemContainer.item.description==='Source'" width="200" height="100" cursor="all-scroll">
        <g stroke="black" stroke-width="1px" fill="white">
          <rect x="27.5px" y="1" width="145" height="90" rx="6.93" ry="6.93" fill="rgb(255,255,255)"
                stroke="rgb(0, 0, 0)"
                stroke-width="2.1"></rect>
          <text x="32%" y="65%" alignment-baseline="middle" text-anchor="middle" fill="black"
                stroke="none">Out:
          </text>
        </g>
        <g stroke="black" stroke-width="1px" fill="white">
          <rect x="27.5px" y="1" width="145" height="36.2" rx="6.93" ry="6.93" fill="#3399ff"
                stroke="rgb(0, 0, 0)"
                stroke-width="2.1"></rect>
          <text x="50%" y="22.5%" alignment-baseline="middle" text-anchor="middle" fill="black"
                stroke="none">{{itemContainer.item.name}}
          </text>
        </g>
      </svg>

      <svg *ngIf="itemContainer.item.description==='Queue'" width="200" height="100" cursor="all-scroll">
        <g stroke="black" stroke-width="1px" fill="white">
          <rect x="27.5px" y="1" width="145" height="90" rx="6.93" ry="6.93" fill="rgb(255,255,255)"
                stroke="rgb(0, 0, 0)"
                stroke-width="2.1"></rect>
          <text x="32%" y="65%" alignment-baseline="middle" text-anchor="middle" fill="black"
                stroke="none">In:
          </text>
        </g>
        <g stroke="black" stroke-width="1px" fill="white">
          <rect x="27.5px" y="1" width="145" height="36.2" rx="6.93" ry="6.93" fill="#00ff99"
                stroke="rgb(0, 0, 0)"
                stroke-width="2.1"></rect>
          <text x="50%" y="22.5%" alignment-baseline="middle" text-anchor="middle" fill="black"
                stroke="none">{{itemContainer.item.name}}
          </text>
        </g>
      </svg>

      <svg *ngIf="itemContainer.item.description==='Server'" width="200" height="100" cursor="all-scroll">
        <g stroke="black" stroke-width="1px" fill="white">
          <rect x="27.5px" y="1" width="145" height="90" rx="6.93" ry="6.93" fill="rgb(255,255,255)"
                stroke="rgb(0, 0, 0)"
                stroke-width="2.1"></rect>
          <text x="32%" y="65%" alignment-baseline="middle" text-anchor="middle" fill="black"
                stroke="none">Util:
          </text>
        </g>
        <g stroke="black" stroke-width="1px" fill="white">
          <rect x="27.5px" y="1" width="145" height="36.2" rx="6.93" ry="6.93" fill="#ffcc00"
                stroke="rgb(0, 0, 0)"
                stroke-width="2.1"></rect>
          <text x="50%" y="22.5%" alignment-baseline="middle" text-anchor="middle" fill="black"
                stroke="none">{{itemContainer.item.name}}
          </text>
        </g>
      </svg>

    </div>
  </div>
</div>

<i id="trash" class="fa-solid fa-trash-can trash fa-4x"></i>
<button class="reset btn btnReset" (click)="resetPositions()"><i class="fa-solid fa-arrows-rotate"></i> Reiniciar
  posiciones
</button>


<div class="modal fade" id="modalNewFolder" tabindex="-1" role="dialog" aria-labelledby="modalSave"
     aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-scrollable" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Guarda la simulación</h5>
      </div>
      <div class="modal-body">
        <label for="nameSimulation" class="col-form-label">Nombre<span class="asterisk">*</span></label>
        <input type="text" class="form-control" id="nameSimulation">
        <div class="form-group mt-3">
          <label for="description-simulation" class="col-form-label">Descripción<span
            class="asterisk">*</span></label>
          <textarea class="form-control" id="description-simulation"></textarea>
        </div>
        <div class="form-group mt-3">
          <label for="image" class="col-form-label">Imagen</label>
          <input class="form-control" id="image" name="image" type="file">
          <div class="imageInfo">Esta imagen irá junto con el nombre y la descripción de la simulación, y
            aparecerán en el directorio de simulaciones.
          </div>
        </div>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
        <button type="button" class="btn btn-danger">Guardar</button>
      </div>
    </div>
  </div>
</div>

<ng-template #deleteConnection let-modal class="modal fade">
  <div class="modal-header">
    <h5>Eliminar conexión</h5>
    <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss()"></button>
  </div>
  <div class="modal-body">
    <p>¿Deseas borrar esta conexión de todas formas?</p>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-secondary" (click)="modal.dismiss()">Cancelar</button>
    <button type="button" class="btn btn-danger" (click)="[modal.dismiss(),deleteConnectionFunction()]">Confirmar
    </button>
  </div>
</ng-template>

<ng-template #quickSimulation let-modal class="modal fade">
  <div class="modal-header">
    <h5 class="modal-title">Simulación rápida</h5>
    <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss()"></button>

  </div>
  <form [formGroup]="quickSimulationForm" (ngSubmit)="simulate()">
    <div class="modal-body">
      <label for="timeSimulation" class="col-form-label">Tiempo de observación [horas]<span
        class="asterisk">*</span></label>
      <input type="number" class="form-control" id="timeSimulation" formControlName="timeSimulation">
      <span *ngIf="timeSimulation && timeSimulation.invalid" class="errorMessage">Debe tener un valor entero mayor que 0 y menor que 20.</span>
      <div class="form-group mt-3">
        <label for="numberSimulations" class="col-form-label">Número de simulaciones<span
          class="asterisk">*</span></label>
        <input type="number" class="form-control" id="numberSimulations" formControlName="numberSimulations">
        <span *ngIf="numberSimulations && numberSimulations.invalid" class="errorMessage">Debe tener un valor entero entre 1 y 5.</span>
      </div>
      <div class="form-group mt-3">
        <label class="col-form-label">Formato de exportación de resultados<span
          class="asterisk">*</span></label>
        <div>
          <input class="checkboxInput" type="checkbox" id="pdf" name="pdf" value="pdf" formControlName="pdfFormat">
          <label class="checkboxLabel" for="pdf">PDF</label>
          <input class="checkboxInput" type="checkbox" id="csv" name="csv" value="csv" formControlName="csvFormat">
          <label for="csv">CSV</label>
        </div>
        <span *ngIf="quickSimulationForm.value.pdfFormat===false && quickSimulationForm.value.csvFormat===false"
              class="errorMessage">Se debe seleccionar al menos un formato.</span>
      </div>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-secondary" data-dismiss="modal" (click)="modal.dismiss()">Cancelar</button>
      <button
        [disabled]="quickSimulationForm.invalid || (quickSimulationForm.value.pdfFormat===false && quickSimulationForm.value.csvFormat===false)"
        type="submit" class="btn btn-danger">Simular
      </button>
    </div>
  </form>
</ng-template>

<ng-template #deleteItem let-modal class="modal fade">
  <div class="modal-header">
    <h5 *ngIf="itemContainerModal.item.description==='Source'" class="modal-title">Eliminar fuente</h5>
    <h5 *ngIf="itemContainerModal.item.description==='Sink'" class="modal-title">Eliminar desagüe</h5>
    <h5 *ngIf="itemContainerModal.item.description==='Queue'" class="modal-title">Eliminar cola</h5>
    <h5 *ngIf="itemContainerModal.item.description==='Server'" class="modal-title">Eliminar procesador</h5>
    <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss()"></button>
  </div>
  <div class="modal-body">
    <p>¿Deseas borrar este item de todas formas?</p>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-secondary" (click)="modal.dismiss()">Cancelar</button>
    <button type="button" class="btn btn-danger" (click)="[modal.dismiss(),deleteItemFunction()]">Confirmar</button>
  </div>
</ng-template>

<ng-template class="modal fade" #editSource let-modal>
  <div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title">Editar Fuente</h5>
      <button type="button" class="btn-close" aria-label="Close" (click)="[resetListNames(),modal.dismiss()]"></button>
    </div>
    <form [formGroup]="editSourceForm" (ngSubmit)="editItem()">
      <div class="modal-body">
        <label for="nameSource" class="col-form-label">Nombre<span
          class="asterisk">*</span></label>
        <input type="text" class="form-control" id="nameSource" formControlName="nameSource">
        <span *ngIf="nameSource && nameSource.invalid && !editSourceForm.controls.nameSource.hasError('invalidFormat')"
              class="errorMessage">Debe tener una longitud de entre 1 y 10 caracteres.</span>
        <span *ngIf="editSourceForm.controls.nameSource.hasError('invalidFormat')" class="errorMessage">Ya existe un item con este nombre.</span>
        <div class="form-group mt-3">

          <label for="interArrivalTime" class="col-form-label">Tiempo entre llegadas<span
            class="asterisk">*</span></label>
          <div ngbDropdown class="dropdown menuDropdown selectMenu">
            <input class="form-control" id="interArrivalTime" formControlName="interArrivalTimeSource">
            <button class="btn ddbutton" type="button" ngbDropdownToggle></button>
            <ul ngbDropdownMenu class="dropdown-menu pre-scrollable">
              <div *ngFor="let probFunc of listProbFunc; let i=index">
                <li ngbDropdownItem>
                  <button class="btnElem" type="button" (click)="setinterArrivalTime(probFunc)">
                    <div>
                      {{probFunc}}
                    </div>
                  </button>
                </li>
                <div *ngIf="i!=listProbFunc.length-1" class="dropdown-divider"></div>
              </div>
            </ul>
          </div>
          <span *ngIf="interArrivalTimeSource && interArrivalTimeSource.invalid" class="errorMessage">No coincide con ninguna opción.</span>
        </div>
        <div class="form-group mt-3">
          <label for="numberProducts" class="col-form-label">
            Número de productos<span class="asterisk">*</span>
          </label>
          <div ngbDropdown class="dropdown menuDropdown selectMenu">
            <input type="text" class="form-control customizeInput" id="numberProducts"
                   placeholder="Selecciona o introduce una cantidad" formControlName="numberProductsSource">
            <button class="btn ddbutton" type="button" ngbDropdownToggle>
            </button>
            <ul class="dropdown-menu" ngbDropdownMenu>
              <li ngbDropdownItem>
                <button class="btnElem" id="limitedSource" type="button" (click)="setNumberProducts('Limitados')">
                  <div>
                    <i class="fa-solid fa-x"></i>Limitados
                  </div>
                </button>
              </li>
              <div class="dropdown-divider"></div>
              <li ngbDropdownItem>
                <button class="btnElem" id="unlimitedSource" type="button" (click)="setNumberProducts('Ilimitados')">
                  <div>
                    <i class="fa-solid fa-infinity"></i>Ilimitados
                  </div>
                </button>
              </li>
            </ul>
          </div>
          <span *ngIf="numberProductsSource && numberProductsSource.invalid" class="errorMessage">Debe ser un número o ser Ilimitados</span>
        </div>
        <div class="form-group mt-3"  *ngIf="numConnections>0">
          <label for="sendToStrategySource" class="col-form-label"></label>
          Enviar a <span class="asterisk">*</span>
          <div class="input-group mt-2">
            <span class="strategy">Strategia:</span>
            <select id="sendToStrategySource" class="form-select strategySelect"
                    formControlName="sendToStrategySource">
              <option selected disabled value="">Selecciona una estrategia</option>
              <option [value]="strategy" *ngFor="let strategy of listSendToStrategies">{{strategy}}</option>
            </select>
          </div>
          <div formGroupName="percentagesSource" class="connections">
            <div class="connectionsTitle">Conexiones:</div>
            <div class="interPercenteges" *ngFor="let connection of itemContainerModal.connections; let i= index;">
              <span class="strategy">{{connection.destinationItem.name}}: </span>
              <input *ngIf="showConnections" type="number" class="form-control inputPercentage" [formControlName]="i">
              <input *ngIf="!showConnections" type="number" class="form-control inputPercentage" placeholder="X"
                     disabled> <span *ngIf="showConnections"> %</span>
            </div>
            <span
              *ngIf="(percentagesSource && percentagesSource.invalid) || (sendToStrategySource && sendToStrategySource.invalid)"
              class="errorMessage">La suma total de todos los porcentajes debe ser 100%</span>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal"
                (click)="[resetListNames(),modal.dismiss()]">Cancelar
        </button>
        <button [disabled]="editSourceForm.invalid" type="submit" class="btn btn-danger"
                (click)="[resetListNames(),modal.dismiss()]">
          Guardar
        </button>
      </div>
    </form>
  </div>
</ng-template>

<ng-template class="modal fade" #editQueue let-modal>
  <div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title">Editar Cola</h5>
      <button type="button" class="btn-close" aria-label="Close" (click)="[resetListNames(),modal.dismiss()]"></button>
    </div>
    <form [formGroup]="editQueueForm" (ngSubmit)="editItem()">
      <div class="modal-body">
        <label for="nameQueue" class="col-form-label">Nombre<span
          class="asterisk">*</span></label>
        <input type="text" class="form-control" id="nameQueue" formControlName="nameQueue">
        <span *ngIf="nameQueue && nameQueue.invalid && !editQueueForm.controls.nameQueue.hasError('invalidFormat')"
              class="errorMessage">Debe tener una longitud de entre 1 y 10 caracteres.</span>
        <span *ngIf="editQueueForm.controls.nameQueue.hasError('invalidFormat')" class="errorMessage">Ya existe un item con este nombre.</span>
        <div class="form-group mt-3">
          <label for="capacityQueue" class="col-form-label">
            Capacidad<span class="asterisk">*</span>
          </label>
          <div ngbDropdown class="dropdown menuDropdown selectMenu">
            <input type="text" class="form-control customizeInput" id="capacityQueue"
                   placeholder="Selecciona o introduce una cantidad" formControlName="capacityQueue">
            <button ngbDropdownToggle class="btn ddbutton" type="button">
            </button>
            <ul ngbDropdownMenu class="dropdown-menu ">
              <li ngbDropdownItem>
                <button class="btnElem" id="limitedCapacityQueue" type="button" (click)="setCapacityQueue('Limitados')">
                  <div>
                    <i class="fa-solid fa-x"></i>Limitados
                  </div>
                </button>
              </li>
              <div class="dropdown-divider"></div>
              <li ngbDropdownItem>
                <button class="btnElem" id="unlimitedCapacityQueue" type="button"
                        (click)="setCapacityQueue('Ilimitados')">
                  <div>
                    <i class="fa-solid fa-infinity"></i>Ilimitados
                  </div>
                </button>
              </li>
            </ul>
          </div>
          <span *ngIf="capacityQueue && capacityQueue.invalid"
                class="errorMessage">Debe ser un número o ser Ilimitados.</span>
        </div>
        <div class="form-group mt-3">
          <label for="queueDiscipline" class="col-form-label">
            Disciplina de la cola<span class="asterisk">*</span>
          </label>
          <div ngbDropdown class="dropdown menuDropdown selectMenu">
            <input type="text" class="form-control customizeInput" id="queueDiscipline"
                   placeholder="Selecciona o introduce una disciplina" formControlName="queueDiscipline">
            <button ngbDropdownToggle class="btn ddbutton" type="button">
            </button>
            <ul ngbDropdownMenu class="dropdown-menu ">
              <li ngbDropdownItem>
                <button class="btnElem" id="fifoQueue" type="button" (click)="setQueueDiscipline('Fifo')">
                  <div>
                    Fifo (First In First Out)
                  </div>
                </button>
              </li>
              <div class="dropdown-divider"></div>
              <li ngbDropdownItem>
                <button class="btnElem" id="lifoQueue" type="button" (click)="setQueueDiscipline('Lifo')">
                  <div>
                    Lifo (Last In First Out)
                  </div>
                </button>
              </li>
              <div class="dropdown-divider"></div>
              <li ngbDropdownItem>
                <button class="btnElem" id="randomQueue" type="button" (click)="setQueueDiscipline('Random')">
                  <div>
                    Random
                  </div>
                </button>
              </li>
            </ul>
          </div>
          <span *ngIf="queueDiscipline && queueDiscipline.invalid"
                class="errorMessage">Debe ser Fifo, Lifo o Random.</span>
        </div>
        <div class="form-group mt-3" *ngIf="numConnections>0">
          <label for="sendToStrategyQueue" class="col-form-label"></label>
          Enviar a <span class="asterisk">*</span>
          <div class="input-group mt-2">
            <span class="strategy">Strategia:</span>
            <select id="sendToStrategyQueue" class="form-select strategySelect"
                    formControlName="sendToStrategyQueue">
              <option selected disabled value="">Selecciona una estrategia</option>
              <option [value]="strategy" *ngFor="let strategy of listSendToStrategies">{{strategy}}</option>
            </select>
          </div>
          <div formGroupName="percentagesQueue" class="connections">
            <div class="connectionsTitle">Conexiones:</div>
            <div class="interPercenteges" *ngFor="let connection of itemContainerModal.connections; let i= index;">
              <span class="strategy">{{connection.destinationItem.name}}: </span>
              <input *ngIf="showConnections" type="number" class="form-control inputPercentage" [formControlName]="i">
              <input *ngIf="!showConnections" type="number" class="form-control inputPercentage" placeholder="X"
                     disabled> <span *ngIf="showConnections"> %</span>
            </div>
            <span
              *ngIf="(percentagesQueue && percentagesQueue.invalid) || (sendToStrategyQueue && sendToStrategyQueue.invalid)"
              class="errorMessage">La suma total de todos los porcentajes debe ser 100%</span>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal"
                (click)="[resetListNames(),modal.dismiss()]">Cancelar
        </button>
        <button [disabled]="editQueueForm.invalid" type="submit" class="btn btn-danger"
                (click)="[resetListNames(),modal.dismiss()]">Guardar
        </button>
      </div>
    </form>
  </div>
</ng-template>

<ng-template class="modal fade" #editServer let-modal>
  <div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title">Editar Procesador</h5>
      <button type="button" class="btn-close" aria-label="Close" (click)="[resetListNames(),modal.dismiss()]"></button>
    </div>
    <form [formGroup]="editServerForm" (ngSubmit)="editItem()">
      <div class="modal-body">
        <label for="nameProcesador" class="col-form-label">Nombre<span
          class="asterisk">*</span></label>
        <input type="text" class="form-control" id="nameProcesador" formControlName="nameServer">
        <span *ngIf="nameServer && nameServer.invalid && !editServerForm.controls.nameServer.hasError('invalidFormat')"
              class="errorMessage">Debe tener una longitud de entre 1 y 10 caracteres.</span>
        <span *ngIf="editServerForm.controls.nameServer.hasError('invalidFormat')" class="errorMessage">Ya existe un item con este nombre.</span>
        <div class="form-group mt-3">
          <label for="setUpTimeServer" class="col-form-label">Tiempo de establecimiento<span
            class="asterisk">*</span></label>
          <input type="number" class="form-control" id="setUpTimeServer" formControlName="setUpTimeServer">
          <span *ngIf="setUpTimeServer && setUpTimeServer.invalid"
                class="errorMessage">Debe tener un valor entero.</span>

        </div>
        <div class="form-group mt-3 ">
          <label for="cycletimeServer" class="col-form-label">
            Duración del ciclo<span class="asterisk">*</span>
          </label>
          <div ngbDropdown class="dropdown menuDropdown selectMenu">
            <input type="text" class="form-control customizeInput" id="cycletimeServer"
                   placeholder="Selecciona o introduce una distribución del ciclo" formControlName="cycletimeServer">
            <button class="btn ddbutton" type="button" ngbDropdownToggle>
            </button>
            <ul ngbDropdownMenu class="dropdown-menu pre-scrollable">
              <div *ngFor="let probFunc of listProbFunc; let i=index">
                <li ngbDropdownItem>
                  <button class="btnElem" type="button" (click)="setcycletimeServer(probFunc)">
                    <div>
                      {{probFunc}}
                    </div>
                  </button>
                </li>
                <div *ngIf="i!=listProbFunc.length-1" class="dropdown-divider"></div>
              </div>
            </ul>
          </div>
          <span *ngIf="cycletimeServer && cycletimeServer.invalid"
                class="errorMessage">No coincide con ninguna opción.</span>
        </div>
        <div class="form-group mt-3" *ngIf="numConnections>0">
          <label for="sendToStrategyServer" class="col-form-label"></label>
          Enviar a <span class="asterisk">*</span>
          <div class="input-group mt-2">
            <span class="strategy">Strategia:</span>
            <select id="sendToStrategyServer" class="form-select strategySelect"
                    formControlName="sendToStrategyServer">
              <option selected disabled value="">Selecciona una estrategia</option>
              <option [value]="strategy" *ngFor="let strategy of listSendToStrategies">{{strategy}}</option>
            </select>
          </div>
          <div formGroupName="percentagesServer" class="connections">
            <div class="connectionsTitle">Conexiones:</div>
            <div class="interPercenteges" *ngFor="let connection of itemContainerModal.connections; let i= index;">
              <span class="strategy">{{connection.destinationItem.name}}: </span>
              <input *ngIf="showConnections" type="number" class="form-control inputPercentage" [formControlName]="i">
              <input *ngIf="!showConnections" type="number" class="form-control inputPercentage" placeholder="X"
                     disabled> <span *ngIf="showConnections"> %</span>
            </div>
            <span
              *ngIf="(percentagesServer && percentagesServer.invalid) || (sendToStrategyServer && sendToStrategyServer.invalid)"
              class="errorMessage">La suma total de todos los porcentajes debe ser 100%</span>
          </div>
        </div>
      </div>
      <div class="modal-footer mt-3">
        <button type="button" class="btn btn-secondary" data-dismiss="modal"
                (click)="[resetListNames(),modal.dismiss()]">Cancelar
        </button>
        <button type="submit" class="btn btn-danger" (click)="[resetListNames(),modal.dismiss()]">Guardar</button>
      </div>
    </form>
  </div>
</ng-template>

<ng-template #editSink let-modal class="modal fade">
  <div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title">Editar Sumidero</h5>
      <button type="button" class="btn-close" aria-label="Close" (click)="[resetListNames(),modal.dismiss()]"></button>
    </div>
    <form [formGroup]="editSinkForm" (ngSubmit)="editItem()">
      <div class="modal-body">
        <label for="nameSink" class="col-form-label">Nombre<span
          class="asterisk">*</span></label>
        <input type="text" class="form-control" id="nameSink" formControlName="nameSink">
        <span *ngIf="nameSink && nameSink.invalid && !editSinkForm.controls.nameSink.hasError('invalidFormat')"
              class="errorMessage">Debe tener una longitud de entre 1 y 10 caracteres.</span>
        <span *ngIf="editSinkForm.controls.nameSink.hasError('invalidFormat')" class="errorMessage">Ya existe un item con este nombre.</span>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal"
                (click)="[resetListNames(),modal.dismiss()]">Cancelar
        </button>
        <button [disabled]="editSinkForm.invalid" type="submit" class="btn btn-danger"
                (click)="[resetListNames(),modal.dismiss()]">Guardar
        </button>
      </div>
    </form>
  </div>
</ng-template>
